import flixel.math.FlxPoint;
import flixel.FlxSprite;
import funkin.graphics.FunkinSprite;
import funkin.play.PlayState;
import flixel.util.FlxTimer;
import flixel.FlxG;
import funkin.audio.FunkinSound;
import funkin.Conductor;
import funkin.Preferences;

// object used for lip sync on characters in SPAGHETTI
class SserafimLipSyncSprite extends FunkinSprite
{
  var shouldSing(default, set):Bool = true;

  function set_shouldSing(value:Bool):Bool
  {
    shouldSing = value;

    if (!value)
    {
      animation.curAnim.curFrame = 0;
    }

    return value;
  }

  public function new(x:Float, y:Float, ?suffix:String)
  {
    super(x, y);

    loadTextureAtlas(suffix != null ? 'sserafim-lipsync-' + suffix : 'sserafim-lipsync', "sserafim");
    animation.addBySymbol("lipsync", this.getDefaultSymbol(), 24, false);
    animation.play("lipsync", true);
  }

  override function update(elapsed:Float):Void
  {
    if (this.animation.curAnim != null && shouldSing)
    {
      this.animation.curAnim.curFrame = Math.floor((Conductor.instance.songPosition / 1000) * 24) - 1;
    }
  }
}
